/*!
 * 2020-12-31日上线，闲语H5是陈刚的第一个全栈项目，自己完成从前端设计，
 * 到后端接口的设计，
 * 以及Linux系统上Redis和MongoDB数据库安装使用，Nginx代理部署，HTTPS以及域名申请，
 * 见证了过去半年所有空闲时间的努力！新的一年，奥利给！我轻轻的来了，又轻轻地走了......
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["group-homepage"],{"07ca":function(t,e,s){},"08ae":function(t,e,s){},"0959":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"xianyu-dictionary-item",class:{"no-mragin-bottom-dic":t.noMarginBottom},domProps:{innerHTML:t._s(t.dictionary)},on:{click:function(e){return t.$emit("click")}}})},a=[],r={name:"DictionaryItem",props:{dictionary:{type:String,required:!1},noMarginBottom:{type:Boolean,default:!1}}},n=r,o=(s("800e"),s("2877")),c=Object(o["a"])(n,i,a,!1,null,"23e4265b",null);e["a"]=c.exports},"1bf3":function(t,e,s){"use strict";s("b74c")},2423:function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return r})),s.d(e,"c",(function(){return n}));var i=s("751a");const a=(t=1,e="")=>i["a"].get(`/articles?current_page=${t}&q=${e}`),r=t=>i["a"].get("/articles/"+t),n=()=>i["a"].post("/articles/hot")},"2d3b":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"xianyu-search"},[s("van-search",{attrs:{"input-align":"left",clearable:"",autofocus:"",placeholder:"搜索好文/诗词/成语/用户","show-action":""},on:{click:function(e){return t.$router.push("/search")},blur:t.userBlur,search:t.onSearch},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")])]},proxy:!0}]),model:{value:t.searchValue,callback:function(e){t.searchValue="string"===typeof e?e.trim():e},expression:"searchValue"}}),t.showSearchArea?s("div",{staticClass:"search-result"},[s("van-tabs",{attrs:{animated:"",swipeable:"",color:"#409fea"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[s("van-tab",{attrs:{title:"好文"}},[s("divide-area"),t.articleResult.length>0?s("div",{staticClass:"search-results-container"},t._l(t.articleResult,(function(e,i){return s("article-item",{key:e._id,attrs:{article:e,"no-margin-bottom":i===t.articleResult.length-1},on:{click:function(s){return t.$router.push("/article-detail/"+e._id)}}})})),1):t._e(),t.articleResult.length<=0&&t.showArticleTag?s("search-empty"):t._e()],1),s("van-tab",{attrs:{title:"诗词"}},[s("divide-area"),t.poemResult.length>0?s("div",{staticClass:"search-results-container"},t._l(t.poemResult,(function(e,i){return s("poem-item",{key:e._id,attrs:{itemvalue:e,"no-margin":i===t.poemResult.length-1},on:{click:function(s){return t.$router.push("/ancient-poetry/"+e._id)}}})})),1):t._e(),t.poemResult.length<=0&&t.showPoemTag?s("search-empty"):t._e()],1),s("van-tab",{attrs:{title:"词典"}},[s("div",{staticClass:"search-word-container"},[s("divide-area"),t.wordResult.length>0?s("div",{staticClass:"search-results-container"},t._l(t.wordResult,(function(e){return s("dictionary-item",{key:e._id,attrs:{dictionary:e.word_title},on:{click:function(s){return t.$router.push("/dictionary-detail/"+e._id)}}})})),1):t._e(),t.wordResult.length<=0&&t.showWordTag?s("search-empty"):t._e()],1)]),s("van-tab",{attrs:{title:"用户"}},[s("divide-area"),t.userResult.length>0?s("div",{staticClass:"search-results-container"},t._l(t.userResult,(function(e,i){return s("follow-item",{key:e._id,attrs:{"no-border-bottom":5===i,user:e,"is-self":e._id===t.userId,"is-follow":t.isLogin&&t.myFollows.includes(e._id)},on:{followMyFans:function(s){return t.followMyFansHandle(e._id)},cancelFollow:function(s){return t.cancelFollowHandle(e._id)}}})})),1):t._e(),t.userResult.length<=0&&t.showUserTag?s("search-empty"):t._e()],1)],1)],1):s("div",{staticClass:"xianyu-search-container"},[t.searchKeyWords.length?s("div",{staticClass:"xianyu-search-container-history"},[s("div",{staticClass:"xianyu-search-container-history-title"},[s("h2",[t._v("历史记录")]),s("i",{staticClass:"iconfont icon-delete",on:{click:t.askClearSearchHistory}})]),s("div",{staticClass:"xianyu-search-container-history-container"},t._l(t.searchKeyWords,(function(e){return s("div",{key:e,staticClass:"xianyu-search-container-history-item",on:{click:function(s){return t.historySearch(e)}}},[t._v(t._s(e))])})),0)]):t._e()])],1)},a=[],r=s("efe7"),n=s("5468"),o=s("be73"),c=s("0959"),l=s("e1da"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"xianyu-search-empty-state"},[s("van-empty",{staticClass:"custom-image",attrs:{image:t.image,"image-size":88,description:"什么都没有哟"}})],1)},h=[],d={name:"SearchEmpty",data(){return{image:s("31eb")}}},m=d,f=(s("bd0e"),s("2877")),p=Object(f["a"])(m,u,h,!1,null,"8689168a",null),g=p.exports,y=s("2423"),w=s("c24f"),v=s("e56e"),_=s("ae0e"),b={name:"Search",data(){return{active:0,searchValue:"",articleResult:[],userResult:[],poemResult:[],wordResult:[],wordCurrentPage:1,poemCurrentPage:1,articleCurrentPage:1,userCurrentPage:1,confirmSearch:!1,userId:null,myFollows:[],showArticleTag:!1,showWordTag:!1,showPoemTag:!1,showUserTag:!1}},mounted(){this.$store.commit("addCachedPages","Search")},deactivated(){"/"===this.$router.currentRoute.fullPath.split("?")[0]&&(this.active=0,this.artcileResult=[],this.poemResult=[],this.userResult=[],this.wordResult=[],setTimeout(()=>{this.searchValue=""},50))},computed:{searchKeyWords(){return this.$store.state.searchKeyWords},searchResultState(){return this.artcileResult.length>0||this.userResult.length>0||this.poemResult.length>0||this.wordResult.length>0},showSearchArea(){return this.searchValue.length>0&&this.confirmSearch},isLogin(){return this.$store.state.token.token},reg(){return new RegExp(this.searchValue,"gi")},replaceString(){return`<span style='color: #e92322'>${this.searchValue}</span>`}},watch:{active:{handler(t){0===t?this.artcileResult.length<=0&&this.searchArticles():1===t?this.poemResult.length<=0&&this.searchPoems():2===t?this.wordResult.length<=0&&this.searchWords():3===t&&this.userResult.length<=0&&this.searchUsers()}},searchValue(t,e){e.length>0&&(this.confirmSearch=!1)}},methods:{onSearch(){if(this.searchValue.trim().length<=0)return this.searchValue="",this.$toast("搜索的内容不能为空！");this.confirmSearch=!0,this.$store.commit("addSearchKeyWords",this.searchValue),this.getSearchResultByActive(this.active)},askClearSearchHistory(){this.$dialog.confirm({title:"是否清除历史记录？",width:"280px"}).then(t=>{this.$store.commit("clearSearchKeyWords"),this.$toast({message:"清除成功！",position:"top"})}).catch(t=>{console.log(t)})},userBlur(){this.artcileResult=this.userResult=this.poemResult=this.wordResult=[]},async searchUsers(){const t=await Object(w["t"])(this.searchValue);if(0===t.errno&&(this.userResult=JSON.parse(JSON.stringify(t.data).replace(this.reg,this.replaceString)),this.userResult.length<=0?this.showUserTag=!0:this.showUserTag=!1,this.isLogin)){const t=await Object(w["p"])();if(0===t.errno&&(this.userId=t.data._id),t.data._id){const e=await Object(w["M"])(t.data._id,this.userCurrentPage);0===e.errno&&e.data.forEach(t=>{this.myFollows.push(t._id)})}}},async searchWords(){const t=await Object(v["b"])(this.wordCurrentPage,this.searchValue);0===t.errno&&(this.wordResult=JSON.parse(JSON.stringify(t.data).replace(this.reg,this.replaceString)),this.wordResult.length<=0?this.showWordTag=!0:this.showWordTag=!1)},async searchPoems(){const t=await Object(_["b"])(this.poemCurrentPage,this.searchValue);0===t.errno&&(this.poemResult=JSON.parse(JSON.stringify(t.data).replace(this.reg,this.replaceString)),this.poemResult.length<=0?this.showPoemTag=!0:this.showPoemTag=!1)},async searchArticles(){const t=await Object(y["b"])(this.articleCurrentPage,this.searchValue);0===t.errno&&(this.articleResult=JSON.parse(JSON.stringify(t.data).replace(this.reg,this.replaceString)),this.articleResult.length<=0?this.showArticleTag=!0:this.showArticleTag=!1)},historySearch(t){this.confirmSearch=!0,this.searchValue=t,this.onSearch()},getSearchResultByActive(t){0===t?this.searchArticles():1===t?this.searchPoems():2===t?this.searchWords():3===t&&this.searchUsers()},async followMyFansHandle(t){if(this.isLogin){const e=await Object(w["L"])(t);0===e.errno&&(this.myFollows.includes(t)||this.myFollows.push(t),this.$toast("关注成功"))}else this.$dialog.confirm({message:'<p style="font-size: 16px;line-height: 25px">此操作需要登录，\n是否跳转到登录页面？</p>',showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"确定",confirmButtonColor:"#409fea",cancelButtonText:"取消",cancelButtonColor:"#666"}).then(()=>{this.$router.replace({path:"/login",query:{redirect:this.$route.fullPath}})}).catch(t=>{console.log(t)})},async cancelFollowHandle(t){const e=await Object(w["A"])(t);if(0===e.errno){const e=this.myFollows.indexOf(t);e>-1&&this.myFollows.splice(e,1),this.$toast("取消关注成功")}}},components:{ArticleItem:n["a"],DivideArea:r["a"],FollowItem:o["a"],DictionaryItem:c["a"],PoemItem:l["a"],SearchEmpty:g}},R=b,C=(s("1bf3"),Object(f["a"])(R,i,a,!1,null,"892a2a5e",null));e["default"]=C.exports},"31eb":function(t,e,s){t.exports=s.p+"img/custom-empty-image.276c05f0.png"},"3ca3":function(t,e,s){"use strict";s("7fa2")},5468:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"xianyu-article-item",class:{"no-margin-bottom":t.noMarginBottom},on:{click:function(e){return t.$emit("click")}}},[s("div",{staticClass:"xianyu-article-item-content"},[s("h1",{staticClass:"xianyu-article-item-content-title",domProps:{innerHTML:t._s(t.article.article_title)}}),s("h3",{staticClass:"xianyu-article-item-content-author",domProps:{innerHTML:t._s(t.article.article_author)}}),s("p",{staticClass:"xianyu-article-item-content-about",domProps:{innerHTML:t._s(t.article.article_introduce)}})]),s("van-image",{attrs:{width:"80px",height:"80px",fit:"cover",src:t.article.article_image},scopedSlots:t._u([{key:"loading",fn:function(){return[s("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[t._v("加载失败")]},proxy:!0}])})],1)},a=[],r={name:"ArticleItem",props:{noMarginBottom:{type:Boolean,default:!1},article:{type:Object,default:()=>{},required:!0}}},n=r,o=(s("3ca3"),s("2877")),c=Object(o["a"])(n,i,a,!1,null,"6fb41a38",null);e["a"]=c.exports},"6bc3":function(t,e,s){"use strict";s("fd93")},"7fa2":function(t,e,s){},"800e":function(t,e,s){"use strict";s("b5e8")},a9e1:function(t,e,s){"use strict";s("07ca")},ae0e:function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return r})),s.d(e,"c",(function(){return n}));var i=s("751a");const a=(t=1,e="")=>i["a"].get(`/poems?current_page=${t}&q=${e}`),r=t=>i["a"].get("/poems/"+t),n=()=>i["a"].post("/poems/hot")},b5e8:function(t,e,s){},b74c:function(t,e,s){},bd0e:function(t,e,s){"use strict";s("08ae")},be73:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"xianyu-fellowing-container-item",class:{none:t.noBorderBottom}},[s("div",{staticClass:"xianyu-fellowing-item-left"},[s("img",{attrs:{src:t.user.avatar_url},on:{click:function(e){return t.$emit("goDetail")}}}),s("div",{staticClass:"xianyu-fellowing-item-left-user"},[s("h1",{domProps:{innerHTML:t._s(t.user.nickname)},on:{click:function(e){return t.$emit("goDetail")}}}),s("span",[t._v(t._s(t.user.personal_sign))])])]),t.isFollow&&!t.isSelf?s("div",{staticClass:"xianyu-fellowing-item-right",on:{click:function(e){return t.$emit("cancelFollow")}}},[t._v(" 取消关注 ")]):t._e(),t.isFollow||t.isSelf?t._e():s("div",{staticClass:"xianyu-fellowing-item-right active",on:{click:function(e){return t.$emit("followMyFans")}}},[t._v(" 关注 ")])])},a=[],r={name:"FollowItem",props:{noBorderBottom:{type:Boolean,default:!1},user:{type:Object,default:()=>{}},isFollow:{type:Boolean,default:!1},isSelf:{type:Boolean,default:!1}}},n=r,o=(s("a9e1"),s("2877")),c=Object(o["a"])(n,i,a,!1,null,"dea39e96",null);e["a"]=c.exports},e1da:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ancient-item",class:{"no-margin":t.noMargin},on:{click:function(e){return t.$emit("click")}}},[s("div",{staticClass:"ancient-item-title"},[s("h1",{domProps:{innerHTML:t._s(t.itemvalue.poem_title)}}),s("p",[t._v(" ["),s("span",{domProps:{innerHTML:t._s(t.itemvalue.author_dynasty)}}),t._v("] ")])]),s("p",{staticClass:"ancient-item-author",domProps:{innerHTML:t._s(t.itemvalue.poem_author)}})])},a=[],r={name:"PoemItem",props:{last:{type:Boolean,default:!0},itemvalue:{type:Object,default:()=>{},required:!0},noMargin:{type:Boolean,default:!1}}},n=r,o=(s("6bc3"),s("2877")),c=Object(o["a"])(n,i,a,!1,null,"a137c460",null);e["a"]=c.exports},e56e:function(t,e,s){"use strict";s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return r}));var i=s("751a");const a=(t=1,e="")=>i["a"].get(`/words?current_page=${t}&q=${e}`),r=t=>i["a"].get("/words/"+t)},fd93:function(t,e,s){}}]);